# 次のタスクまとめ

**作成日**: 2026-01-05  
**目的**: プロジェクトの未実装機能と次のタスクを整理

---

## 検索アイコンの表示問題

### 現状
- `icons.svg`に`icon-search`シンボルは定義済み（121-124行目）
- `index.html`で`<use href="#icon-search"></use>`を参照（2112行目）
- ブラウザ（ポート5273）で虫眼鏡アイコンが表示されない

### 考えられる原因
1. SVGスプライトの読み込みタイミング問題
2. ブラウザキャッシュの問題
3. `icons.svg`の読み込みパスの問題

### 対応（修正済み）
- **原因**: `icons.svg`には`icon-search`が定義されていたが、`index.html`のインラインSVGスプライト（1608-1692行目）に含まれていなかった
- **修正**: `index.html`のインラインSVGスプライトに`icon-search`シンボルを追加
- **確認**: ブラウザでハードリロード（Ctrl+Shift+R）してキャッシュをクリアし、虫眼鏡アイコンが表示されることを確認

---

## 未実装機能の整理

### 高優先度（即時対応可能）

#### 1. Phase 2グラフビューの拡張機能
**現状**: TASK_013で読み取り専用の最小実装が完了  
**未実装項目**:
- 編集機能（ノード追加・削除、エッジ編集）
- ミニマップ
- 複数選択・一括移動
- グリッドスナップ
- 条件・効果のインジケータ表示
- ウィンドウサイズ変更時の自動再レイアウト

**参考**: `docs/NEXT_PHASE_PROPOSAL.md`の「ステップ3：エッジ（選択肢）操作」「ステップ4：インライン編集」「ステップ5：高度機能」

#### 2. GUIエディタのバッチ操作強化
**現状**: 選択肢一括編集は実装済み  
**未実装項目**:
- ノードテキスト一括置換
- 正規表現サポート

**参考**: `docs/NEXT_PHASE_PROPOSAL.md`の「Phase 3: ストーリー作成効率化（拡張）」

#### 3. マルチエンディング可視化
**現状**: 未実装  
**機能**:
- 全エンディングパスを自動抽出
- ツリー構造で表示
- 各エンディングへの到達条件表示

**参考**: `docs/NEXT_PHASE_PROPOSAL.md`の「Phase 4: プレビュー＆検証機能」

### 中優先度（1-2週間）

#### 4. GUIエディタの高度なショートカット
**未実装項目**:
- `Ctrl+Z` / `Ctrl+Y`: 元に戻す/やり直す
- `Ctrl+F`: 検索（既存の検索機能と統合）
- `Ctrl+D`: 選択複製
- `Delete`: ノード削除
- `Space`: パンモード切り替え

**参考**: `docs/NEXT_PHASE_PROPOSAL.md`の「Phase 6: パフォーマンス＆UX改善」

#### 5. エクスポート機能拡張
**現状**: JSON, CSVのみ対応  
**追加予定**:
- Twine互換形式
- Inkフォーマット
- Yarn Spinner形式
- Excel/Google Sheets
- PDF（フローチャート）

**参考**: `docs/NEXT_PHASE_PROPOSAL.md`の「Phase 5: コラボレーション＆エクスポート機能」

#### 6. レキシコンGUIクイック追加
**現状**: 一部実装済み（`lexicon-ui-manager.js`）  
**未実装項目**:
- GUIからのクイック追加フォームの改善
- より直感的なUI

**参考**: `docs/TECHNICAL_DEBT.md`の「レキシコン拡張」

### 低優先度（将来実装）

#### 7. バージョン管理統合
**機能**:
- Gitライクな変更履歴
- コミット・ロールバック機能
- 差分表示

**参考**: `docs/NEXT_PHASE_PROPOSAL.md`の「Phase 5: コラボレーション＆エクスポート機能」

#### 8. マルチユーザー編集
**機能**:
- リアルタイムコラボレーション
- ロック機能（編集中ノードのロック）
- 変更通知

**参考**: `docs/NEXT_PHASE_PROPOSAL.md`の「Phase 5: コラボレーション＆エクスポート機能」

#### 9. 大規模モデル対応
**機能**:
- 仮想化スクロール強化
- 遅延読み込み
- インクリメンタル保存

**参考**: `docs/NEXT_PHASE_PROPOSAL.md`の「Phase 6: パフォーマンス＆UX改善」

#### 10. アクセシビリティ改善
**未実装項目**:
- ARIAラベル追加
- キーボードナビゲーション改善
- スクリーンリーダー対応

**参考**: `docs/TECHNICAL_DEBT.md`の「アクセシビリティ改善」

#### 11. レスポンシブデザイン
**未実装項目**:
- モバイル対応
- タブレット対応
- ブレークポイント設定

**参考**: `docs/TECHNICAL_DEBT.md`の「レスポンシブデザイン」

---

## 技術的負債

### 高優先度

#### 1. main.jsのリファクタリング
**現状**: 約2200行と大きく、複数の責務が混在  
**提案する分割**:
- `bootstrap.js`: 初期化・環境検出
- `ui-bindings.js`: DOM要素取得・イベントバインド
- `session-controller.js`: セッション管理
- `app.js`: エントリーポイント

**参考**: `docs/TECHNICAL_DEBT.md`の「main.jsのリファクタリング」

#### 2. index.htmlのインラインCSS削除
**現状**: 外部CSS追加後もインラインCSSが残存（~1600行）  
**対応**: ファイルサイズ削減のため、将来的に削除を検討

**参考**: `docs/TECHNICAL_DEBT.md`の「index.htmlのインラインCSS削除」

### 中優先度

#### 3. チャンクサイズ警告
**現状**: ビルド時に500KB超過警告  
**対応案**:
- `build.rollupOptions.output.manualChunks`で分割
- 動的importでコード分割

**参考**: `docs/TECHNICAL_DEBT.md`の「チャンクサイズ警告」

---

## 推奨実装順序

### 即時対応（テスト・安定化）
1. **検索アイコンの表示問題の調査・修正**
   - ブラウザの開発者ツールでSVGスプライトの読み込み状況を確認
   - 必要に応じて修正タスクを起票

2. **TASK_009の手動テスト継続**
   - 検索・フィルタ機能のテスト（TASK_014で修正完了）
   - 残りのテストケース（スニペット、カスタムテンプレート、モデル検証等）

### 次期実装（1-2週間）
1. **Phase 2グラフビューの拡張機能**
   - 編集機能（ノード追加・削除、エッジ編集）
   - ミニマップ
   - 複数選択・一括移動
   - 工数: 7-11日

2. **GUIエディタのバッチ操作強化**
   - ノードテキスト一括置換
   - 正規表現サポート
   - 工数: 1-2日

### 将来実装（1ヶ月以降）
1. **マルチエンディング可視化**（工数: 2-3日）
2. **エクスポート機能拡張**（工数: 3-5日）
3. **バージョン管理統合**（工数: 5-7日）
4. **main.jsのリファクタリング**（工数: 3-5日）

---

## 参考資料

- `docs/NEXT_PHASE_PROPOSAL.md`: 次フェーズ開発提案の詳細
- `docs/TECHNICAL_DEBT.md`: 技術的負債と改善タスク
- `docs/OpenSpec-WebTester.md`: Web Testerの仕様（未実装機能の記載あり）
- `docs/reports/REPORT_TASK_013_Phase2ReadOnlyGraphView.md`: Phase 2グラフビューの実装レポート
- `features-status.md`: 機能ステータス一覧
