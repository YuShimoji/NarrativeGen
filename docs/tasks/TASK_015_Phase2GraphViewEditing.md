# Task: Phase 2グラフビューの編集機能実装

Status: CLOSED
Tier: 2
Branch: main
Owner: Worker
Created: 2026-01-05T01:15:00Z
Report: docs/inbox/REPORT_TASK_015_Phase2GraphViewEditing.md

## Objective

Phase 2グラフビュー（TASK_013で実装済み）に編集機能を追加する。読み取り専用から編集可能なグラフエディタへ拡張し、ノード追加・削除、エッジ編集を実装する。

## Context

- TASK_013で読み取り専用のグラフビュー（スパイク）が実装完了
- 既存のリスト形式GUIエディタは詳細なプロパティ編集に適しているが、構造の俯瞰・接続編集には不向き
- グラフビューに編集機能を追加することで、ストーリー構造の直感的な編集が可能になる
- `docs/NEXT_PHASE_PROPOSAL.md`の「ステップ3：エッジ（選択肢）操作」「ステップ4：インライン編集」を参考にする

## Focus Area

- `apps/web-tester/src/ui/graph-editor/GraphEditorManager.js`: 編集機能の追加
- ノード追加・削除機能の実装
- エッジ（選択肢）の追加・削除・編集機能の実装
- インライン編集機能（ノードダブルクリックで編集モード）
- `GuiEditorManager`との状態同期の維持

## Forbidden Area

- 既存のリスト形式GUIエディタの破壊的変更（補完のみ）
- 既存のD3.jsグラフ（`graph.js`）の破壊的変更（段階的置換を想定）
- 既存の読み取り専用機能の削除

## Constraints

- `docs/NEXT_PHASE_PROPOSAL.md`の設計を参照する
- 既存のGUIエディタ（`GuiEditorManager`）との状態同期を維持
- 編集操作は即座にモデルに反映し、GUIエディタと同期する
- 最小実装のため、高度機能（ミニマップ、複数選択等）は将来の拡張とする

## DoD

- [x] ノード追加機能の実装（ツールパレットからドラッグ＆ドロップ、または右クリックメニュー）
- [x] ノード削除機能の実装（ノード選択→Deleteキー、または右クリックメニュー）
- [x] エッジ（選択肢）追加機能の実装（ノード間ドラッグで接続作成）
- [x] エッジ（選択肢）削除機能の実装（エッジ選択→Deleteキー、または右クリックメニュー）
- [x] インライン編集機能の実装（ノードダブルクリックで編集モード、テキスト・選択肢のインライン編集）
- [x] `GuiEditorManager`との状態同期を確認（編集操作がGUIエディタに即座に反映される）
- [x] サンプルモデルで動作確認
- [x] docs/inbox/ にレポート（REPORT_TASK_015_*.md）が作成されている
- [x] 本チケットの Report 欄にレポートパスが追記されている

## Notes

- 本タスクはTASK_013の拡張として、編集機能を追加する
- 将来的な拡張（ミニマップ、複数選択・一括移動、グリッドスナップ、条件・効果のインジケータ表示）は別タスクとして起票する
- `docs/NEXT_PHASE_PROPOSAL.md`の「ステップ3：エッジ（選択肢）操作」「ステップ4：インライン編集」を参考にする
