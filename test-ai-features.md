# 言い換え・バリアント生成 テスト手順（非AI中心 / AI補助オプション）

## 前提条件
- Web Tester が起動している（`npm run dev:tester` → http://localhost:5173）
- OpenAI API キーは任意（AI連携する場合のみ取得：https://platform.openai.com/api-keys）

## テスト手順

### 1. 非AI バリアント生成テスト（推奨・即時実行可能）
1. Web Tester を起動: `npm run dev:tester` → http://localhost:5173
2. サンプルモデルを読み込む（例: linear）
3. 「モデル編集」ボタンをクリックしてGUI編集モードに入る
4. 任意の選択肢テキストの横にある「言い換え」ボタンをクリック
5. 期待結果:
   - テキスト入力欄が即時に別表現へ置換（同義語・文体変換）
   - APIキー不要・オフライン動作
   - 複数回クリックで異なるバリエーション生成

### 2. AI連携設定（任意）
1. 「AI」タブをクリック
2. AI Provider で「mock」を選択（デフォルト・テスト用）
3. 「設定を保存」ボタンをクリック
4. 期待結果: 「AI設定を保存しました」と表示

### 3. AI連携テスト（APIキー取得済みの場合のみ）
1. AI Provider で「openai」を選択
2. 有効なAPIキーを入力
3. モデル名を確認（デフォルト: gpt-3.5-turbo）
4. 「設定を保存」ボタンをクリック
5. サンプルモデルを読み込む
6. 「次のノードを生成」ボタンをクリック
7. 期待結果: AI出力エリアに自然な日本語テキストが生成される

### 4. AI言い換えテスト（APIキー取得済みの場合のみ）
1. 現在のノードにテキストがある状態で
2. 「現在のテキストを言い換え」ボタンをクリック
3. 期待結果: AI出力エリアに複数の言い換えバリエーションが表示される

## 期待される結果

### 非AI バリアント生成（推奨）
- ✅ 即時生成（<100ms）
- ✅ オフライン動作（APIキー不要）
- ✅ 決定的なバリエーション（同じシードで同じ結果）
- ✅ 同義語置換・文体変換が適切
- ✅ 複数クリックで異なるバリエーション

### AI連携（任意・APIキー必要）
- ✅ 自然な日本語テキストが生成される
- ✅ 生成テキストが文脈に沿っている
- ✅ 言い換えが元のテキストの意味を保持している
- ✅ API エラー時に適切なエラーメッセージが表示される
- ✅ APIキーが無効な場合にエラーが表示される

## エラーケースのテスト

### 非AI バリアント生成
- テキスト入力欄が空の場合: 「言い換え」ボタンクリックで適切なメッセージ表示
- モデル未読み込み: GUI編集に入れず「まずモデルを読み込んでください」表示

### AI連携（任意）
- APIキーが未設定: OpenAIを選択してAPIキーを空欄のまま実行 → 「OpenAI APIキーを設定してください」
- 無効なAPIキー: 無効キーで実行 → 「AIプロバイダーの初期化に失敗しました」
- モデル未読み込み: AI機能実行 → 「モデルを読み込んでから実行してください」
- ネットワークエラー: 切断状態でOpenAI実行 → 適切なエラーメッセージ

## ログ確認

ブラウザの開発者ツールのコンソールで以下を確認：
```javascript
// ログの確認
JSON.parse(sessionStorage.getItem('narrativeGenLogs'))
```

以下のログエントリが記録されていることを確認：
- `Operation started` / `Operation completed` for 非AIバリアント生成
- `Operation started` / `Operation completed` for AI operations（設定されている場合）
- エラー発生時の詳細なスタックトレース

## パフォーマンス確認

### 応答時間
- 非AI バリアント生成: <10ms（即時）
- AI連携（mock）: <100ms
- AI連携（OpenAI API）: 1-5秒（ネットワーク状況による）

### UI応答性
- ✅ 生成中もUIがフリーズしない
- ✅ ローディング表示が適切
- ✅ 非AIはキャンセル不要（即時完了）
- ✅ AI連携はキャンセル可能（将来実装）

## 次のステップ

テストが全て成功したら：
1. 非AIバリアント生成の使用方法をドキュメント化
2. README に言い換え機能の説明を追加（AIは補助オプションとして）
3. AI連携の設定ガイド作成（任意）
