# AI機能テスト手順

## 前提条件
- OpenAI API キーを取得済み（https://platform.openai.com/api-keys）
- Web Tester が起動している

## テスト手順

### 1. AI設定タブを開く
1. Web Tester を起動: `npm run dev:tester`
2. ブラウザで http://localhost:5173 を開く
3. 「AI」タブをクリック

### 2. OpenAI APIキーを設定
1. AI Provider で「openai」を選択
2. APIキーを入力
3. モデル名を確認（デフォルト: gpt-3.5-turbo）
4. 「設定を保存」ボタンをクリック
5. 「AI設定を保存しました」と表示されることを確認

### 3. モックプロバイダーのテスト
1. AI Provider で「mock」を選択
2. 「設定を保存」をクリック
3. サンプルモデルを読み込む（例: linear）
4. 「次のノードを生成」ボタンをクリック
5. AI出力エリアに「次のシーンへ進みます。」などのサンプルテキストが表示されることを確認

### 4. 言い換え機能のテスト（モック）
1. 現在のノードにテキストがある状態で
2. 「現在のテキストを言い換え」ボタンをクリック
3. AI出力エリアに複数のバリエーションが表示されることを確認

### 5. OpenAI APIを使用したテスト（APIキー必要）
1. AI Provider で「openai」を選択し、有効なAPIキーを設定
2. 「設定を保存」をクリック
3. サンプルモデルを読み込む
4. 「次のノードを生成」ボタンをクリック
5. AI出力エリアに自然な日本語で生成されたテキストが表示されることを確認
   - 2-4文程度の長さ
   - 物語の続きとして自然な内容
6. 「現在のテキストを言い換え」ボタンをクリック
7. AI出力エリアに複数の言い換えバリエーションが表示されることを確認

## 期待される結果

### モックプロバイダー
- ✅ ランダムなサンプルテキストが即座に表示される
- ✅ エラーが発生しない
- ✅ 複数回実行しても安定動作

### OpenAIプロバイダー
- ✅ 自然な日本語テキストが生成される
- ✅ 生成テキストが文脈に沿っている
- ✅ 言い換えが元のテキストの意味を保持している
- ✅ API エラー時に適切なエラーメッセージが表示される
- ✅ APIキーが無効な場合にエラーが表示される

## エラーケースのテスト

### 1. APIキーが未設定
- OpenAI を選択してAPIキーを空欄のまま「次のノードを生成」を実行
- 「OpenAI APIキーを設定してください」と表示されることを確認

### 2. 無効なAPIキー
- 無効なAPIキーを設定して実行
- 「AIプロバイダーの初期化に失敗しました」とエラーが表示されることを確認

### 3. モデル未読み込み
- モデルを読み込まずにAI機能を実行
- 「モデルを読み込んでから実行してください」と表示されることを確認

### 4. ネットワークエラー
- ネットワークを切断してOpenAI APIを実行
- 適切なエラーメッセージが表示されることを確認

## ログ確認

ブラウザの開発者ツールのコンソールで以下を確認：
```javascript
// ログの確認
JSON.parse(sessionStorage.getItem('narrativeGenLogs'))
```

以下のログエントリが記録されていることを確認：
- `Operation started` / `Operation completed` for AI operations
- エラー発生時の詳細なスタックトレース

## パフォーマンス確認

### 応答時間
- モックプロバイダー: <100ms
- OpenAI API: 1-5秒（ネットワーク状況による）

### UI応答性
- ✅ 生成中もUIがフリーズしない
- ✅ ローディング表示が適切
- ✅ キャンセル可能（将来実装）

## 次のステップ

テストが全て成功したら：
1. ドキュメントを更新（AI機能の使用方法）
2. README にAI機能の説明を追加
3. Phase 3（ローカルLLM統合）の準備
